<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>{% block title %}Administration - Notations{% endblock %}</title>
	{% load static %}
	<link rel="stylesheet" href="{% static 'css/base_connexion.css' %}">
	<link rel="stylesheet" href="{% static 'css/admin-login.css' %}">


    <script>
		// √âviter le flash de th√®me - ex√©cution imm√©diate
		(function () {
			const savedTheme = localStorage.getItem('theme') || localStorage.getItem('admin-theme');
			const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
				document.documentElement.classList.add('dark-theme');
			}
		})();
	</script>
</head>
<body>
    <!-- Navigation principale -->
    <header>
        <nav class="header-nav" role="navigation" aria-label="Navigation principale">
            <a href="{% url 'admin:index' %}" class="logo" aria-label="Retour √† l'accueil Administration">
                {% block branding %}Administration{% endblock %}
            </a>
            <div class="admin-nav">
                <a href="/" class="admin-link" aria-label="Retour au site">
                    <span class="admin-icon" aria-hidden="true">üè†</span>
                    ABC
                </a>
                <button 
                    class="theme-toggle" 
                    id="theme-toggle"
                    aria-label="Basculer entre th√®me clair et sombre"
                    title="Changer de th√®me"
                >
                    <span class="theme-icon" aria-hidden="true">üåô</span>
                </button>
            </div>
        </nav>
    </header>

    <!-- Contenu principal -->
    <main class="main-content">
        <section class="login-section" aria-labelledby="login-title">
            <h1 id="login-title" class="login-title">Administration üîê</h1>
            
            {% if form.errors %}
                <ul class="errorlist">
                    {% for error in form.non_field_errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            {% endif %}

            {% if messages %}
                <ul class="messages">
                    {% for message in messages %}
                        <li class="{{ message.tags }}">{{ message }}</li>
                    {% endfor %}
                </ul>
            {% endif %}

            <form class="login-form" method="post" action="{% url 'admin:login' %}" novalidate aria-describedby="security-info">
                {% csrf_token %}
                
                <div class="form-field">
                    <label for="id_username">{{ form.username.label_tag }}</label>
                    <input 
                        type="text" 
                        id="id_username" 
                        name="username"
                        value="{{ form.username.value|default_if_none:'' }}"
                        required 
                        autocomplete="username"
                        placeholder="Nom d'utilisateur"
                        aria-describedby="username-help"
                        {% if form.username.errors %}class="error"{% endif %}
                        minlength="1"
                        maxlength="150"
                    >
                    {% if form.username.errors %}
                        <ul class="errorlist">
                            {% for error in form.username.errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>

                <div class="form-field">
                    <label for="id_password">{{ form.password.label_tag }}</label>
                    <input 
                        type="password" 
                        id="id_password" 
                        name="password"
                        required 
                        autocomplete="current-password"
                        placeholder="Mot de passe"
                        aria-describedby="password-help"
                        {% if form.password.errors %}class="error"{% endif %}
                        minlength="1"
                    >
                    {% if form.password.errors %}
                        <ul class="errorlist">
                            {% for error in form.password.errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>

                <input type="hidden" name="next" value="{{ next }}">
                
                <button type="submit" class="submit-button">
                    Se connecter
                </button>
            </form>
{% comment %}
            <aside class="security-info" id="security-info" role="complementary">
                <p>
                    <span class="security-icon" aria-hidden="true">üîí</span>
                    Acc√®s administrateur s√©curis√©
                </p>
            </aside>
	    {% endcomment %}
        </section>
    </main>
<script src="{% static 'js/loginManager.js' %}"></script>
<script src="{% static 'js/admin-login.js' %}"></script>

	</body>
	
	</html>
